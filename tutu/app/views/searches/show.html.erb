
<h1>Поиск билета</h1>

<p>
  <%= form_for search_path, method: :post do %>
    <div class="field">
      <p> 
        <%= label_tag "Начальная станция:" %>
        <%= select_tag :first_station_id, options_from_collection_for_select(RailwayStation.all, :id, :title, params[:first_station_id]) %>
      </p>

      <p>
        <%= label_tag "Конечная станция:" %>
        <%= select_tag :last_station_id, options_from_collection_for_select(RailwayStation.all, :id, :title, params[:last_station_id]) %>
      </p>
    </div>

    <%= submit_tag 'Поиск' %>
  <% end %>
</p>


<p>
  <% if @trains.present? %>
    <h2>Список поездов</h2>
    <table>
      <thead>
        <tr>
          <td>Номер</td>
          <td>Маршрут</td>
          <td>Время отправления</td>
          <td>Время прибытия</td>
          <td></td>
        </tr>
      </thead>

      <tbody>
        <% @trains.each do |train| %>
          <tr>
            <td> <%= train.number %> </td>
            <td> <%= train.route.name %> </td>
            <td> <%= train.route.railway_stations.first.departure(train.route).try(:strftime, "%H:%M") %> </td>
            <td> <%= train.route.railway_stations.last.arrival(train.route).try(:strftime, "%H:%M") %> </td>
            <td> <%= link_to 'Купить', new_ticket_path %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    По данному направлению билетов не найдено!
  <% end %>
</p>
